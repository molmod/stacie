<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Frequency Cutoff" href="cutoff.html"><link rel="prev" title="Model Spectrum" href="model.html">
        <link rel="prefetch" href="../_static/stacie-logo-black.svg" as="image">
        <link rel="prefetch" href="../_static/stacie-logo-white.svg" as="image">

    <link rel="shortcut icon" href="../_static/stacie-logo-black.svg"><!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Parameter Estimation - STACIE 1.2</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-codeautolink.css?v=b2176991" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=d923d65c" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --admonition-title-font-size: 1rem;
  --admonition-font-size: 1rem;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-title-font-size: 1rem;
  --admonition-font-size: 1rem;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-title-font-size: 1rem;
  --admonition-font-size: 1rem;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">STACIE 1.2</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/stacie-logo-black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/stacie-logo-white.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">STACIE 1.2</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><input aria-label="Toggle navigation of Getting Started" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/licenses.html">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/usage.html">Usage Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/cite.html">How to Cite</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Theory</a><input aria-label="Toggle navigation of Theory" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notation.html">Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html">STACIE Algorithm Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html">Model Spectrum</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Parameter Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cutoff.html">Frequency Cutoff</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../preparing_inputs/index.html">Preparing Inputs</a><input aria-label="Toggle navigation of Preparing Inputs" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../preparing_inputs/data_sufficiency.html">How to Prepare Sufficient Inputs for STACIE?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preparing_inputs/block_averages.html">Reducing Storage Requirements with Block Averages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preparing_inputs/molecular_dynamics.html">Recommendations for MD Simulations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../properties/index.html">Properties Derived from the Autocorrelation Function</a><input aria-label="Toggle navigation of Properties Derived from the Autocorrelation Function" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../properties/error_estimates.html">Uncertainty of the Mean of Time-Correlated Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/autocorrelation_time.html">Integrated and Exponential Autocorrelation Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/shear_viscosity.html">Shear Viscosity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/bulk_viscosity.html">Bulk Viscosity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/thermal_conductivity.html">Thermal Conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/electrical_conductivity.html">Ionic Electrical Conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/diffusion_coefficient.html">Diffusion Coefficient</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Worked Examples</a><input aria-label="Toggle navigation of Worked Examples" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/minimal.html">Minimal Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/error_mean.html">Uncertainty of the Mean of Time-Correlated Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/applicability.html">Applicability of the Lorentz Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/surface_diffusion.html">Diffusion on a Surface with Newtonian Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/lj_shear_viscosity.html">Shear Viscosity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/lj_bulk_viscosity.html">Bulk Viscosity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/lj_thermal_conductivity.html">Thermal Conductivity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/molten_salt.html">Ionic Electrical Conductivity of Molten Sodium Chloride at 1100 K (OpenMM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/utils.html">Utility Module for Plots Reused in Multiple Examples.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/cloud_cover.html">Correlation Time Analysis of Cloud Cover Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/modules.html">Application Programming Interface</a><input aria-label="Toggle navigation of Application Programming Interface" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/stacie.html">stacie package</a><input aria-label="Toggle navigation of stacie package" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.conditioning.html">stacie.conditioning module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.cost.html">stacie.cost module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.cutoff.html">stacie.cutoff module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.estimate.html">stacie.estimate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.model.html">stacie.model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.plot.html">stacie.plot module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.spectrum.html">stacie.spectrum module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.synthetic.html">stacie.synthetic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/stacie.utils.html">stacie.utils module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../development/index.html">Development</a><input aria-label="Toggle navigation of Development" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/contributing.html">Contributor Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/setup.html">Development Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/changelog.html">Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/release.html">How to Make a Release</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of Conduct</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/molmod/stacie/blob/main/docs/theory/statistics.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/molmod/stacie/edit/main/docs/theory/statistics.md" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="parameter-estimation">
<h1>Parameter Estimation<a class="headerlink" href="#parameter-estimation" title="Link to this heading">¶</a></h1>
<p>Before discussing how to fit a model to spectral data,
we first review the statistics of the sampling <a class="reference internal" href="../glossary.html#term-PSD"><span class="xref std std-term">PSD</span></a>.
Given these statistical properties,
we can derive the likelihood that certain model parameters explain the observed PSD.</p>
<section id="statistics-of-the-sampling-power-spectral-distribution">
<h2>Statistics of the Sampling Power Spectral Distribution<a class="headerlink" href="#statistics-of-the-sampling-power-spectral-distribution" title="Link to this heading">¶</a></h2>
<p>When constructing an estimate of a discrete PSD from a finite amount of data,
it is bound to contain some <a class="reference internal" href="../glossary.html#term-Uncertainty"><span class="xref std std-term">uncertainty</span></a>, which will be characterized below.</p>
<p>The estimate of the PSD is sometimes also called
the <a class="reference external" href="https://en.wikipedia.org/wiki/Periodogram">periodogram</a> or the (empirical) power spectrum.</p>
<p>Consider a periodic random real sequence <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span> with elements <span class="math notranslate nohighlight">\(\hat{x}_n\)</span> and period <span class="math notranslate nohighlight">\(N\)</span>.
For practical purposes, it is sufficient to consider one period of this infinitely long sequence.
The mean of the sequence is zero, and its covariance is <span class="math notranslate nohighlight">\(\cov[\hat{x}_n \,,\, \hat{x}_m]\)</span>.
The distribution of the sequence is stationary,
i.e., each time translation of a sequence results in an equally probable sample.
As a result, the covariance has a circulant structure:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \cov[\hat{x}_n \,,\, \hat{x}_m] = c_\Delta = c_{-\Delta}
\]</div>
</div>
<p>with <span class="math notranslate nohighlight">\(\Delta=n-m\)</span>.
Thus, we can express the covariance with a single index and treat it as a real periodic sequence,
albeit not stochastic.
<span class="math notranslate nohighlight">\(c_\Delta\)</span> is also known as the autocovariance or autocorrelation function of the stochastic process
because it expresses the covariance of a sequence <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span>
with itself translated by <span class="math notranslate nohighlight">\(\Delta\)</span> steps.</p>
<p>The discrete Fourier transform of the sequence is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \hat{X}_k = \sum_{n=0}^{N-1} \hat{x}_n \omega^{-kn}
\]</div>
</div>
<p>with <span class="math notranslate nohighlight">\(\omega = e^{2\pi i/N}\)</span>.</p>
<p>A well-known property of circulant matrices is that their eigenvectors
are sine- and cosine-like basis functions.
As a result, the covariance of the discrete Fourier transform <span class="math notranslate nohighlight">\(\hat{\mathbf{X}}\)</span> becomes diagonal.
To make this derivation self-contained, we write out the mean and covariance of <span class="math notranslate nohighlight">\(\hat{X}_k\)</span> explicitly.
Note that the operators <span class="math notranslate nohighlight">\(\mean[\cdot]\)</span>, <span class="math notranslate nohighlight">\(\var[\cdot]\)</span>, and <span class="math notranslate nohighlight">\(\cov[\cdot,\cdot]\)</span>
are expected values over all possible realizations of the sequence.</p>
<p>For the expected value of the Fourier transform,
we take advantage of the fact that all time translations of <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span>
belong to the same distribution.
We can explicitly compute the average over all time translations,
in addition to computing the mean, without loss of generality.
In the last steps, the index <span class="math notranslate nohighlight">\(n\)</span> is relabeled to <span class="math notranslate nohighlight">\(n-m\)</span>, and some factors are rearranged,
after which the sums can be worked out.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    E[\hat{X}_k]
        &amp;= \mean\left[
            \sum_{n=0}^{N-1} \hat{x}_n \omega^{-kn}
        \right]
        \\
        &amp;= \mean\left[
            \frac{1}{N} \sum_{m=0}^{N-1}\sum_{n=0}^{N-1} \hat{x}_{n+m} \omega^{-kn}
        \right]
        \\
        &amp;= \mean\left[
            \frac{1}{N}
            \underbrace{\left(\sum_{m=0}^{N-1} \omega^{km}\right)}_{=0}
            \sum_{n=0}^{N-1} \hat{x}_{n} \omega^{-kn}
        \right]
        \\
        &amp;= 0
\end{split}\]</div>
</div>
<p>The derivation of the covariance uses similar techniques.
In the following derivation, <span class="math notranslate nohighlight">\(*\)</span> stands for complex conjugation.
Halfway through, the summation index <span class="math notranslate nohighlight">\(n\)</span> is written as <span class="math notranslate nohighlight">\(n=\Delta+m\)</span>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \cov[\hat{X}^*_k\,,\,\hat{X}_\ell]
    &amp;= \cov\left[
        \sum_{m=0}^{N-1} \hat{x}_m \omega^{km}
        \,,\,
        \sum_{n=0}^{N-1} \hat{x}_n \omega^{-\ell n}
    \right]
    \\
    &amp;= \sum_{m=0}^{N-1} \sum_{n=0}^{N-1} \omega^{km-\ell n} c_{n-m}
    \\
    &amp;= \sum_{m=0}^{N-1} \omega^{km-\ell m}\, \sum_{\Delta=0}^{N-1} \omega^{-\ell\Delta} c_\Delta
    \\
    &amp;= N\delta_{k,\ell} \,\mathcal{F}[c]_\ell
\end{split}\]</div>
</div>
<p>To finalize the result,
we need to work out the discrete Fourier transform of the autocorrelation function, <span class="math notranslate nohighlight">\(c_\Delta\)</span>.
Again, we make use of the freedom to insert a time average when computing a mean.
Note that this derivation assumes <span class="math notranslate nohighlight">\(\mean[\hat{x}_n]=0\)</span> to keep the notation bearable.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    C_k = \mathcal{F}[\mathbf{c}]_k
    &amp;= \sum_{\Delta=0}^{N-1} \omega^{-k\Delta} \mean\left[
        \frac{1}{N}
        \sum_{n=0}^{N-1}\hat{x}_n\, \hat{x}_{n+\Delta}
    \right]
    \\
    &amp;= \frac{1}{N} \mean\left[
        \sum_{n=0}^{N-1}\omega^{kn}\hat{x}_n\,
        \sum_{\Delta=0}^{N-1}\omega^{-k\Delta-kn} \hat{x}_{n+\Delta}
    \right]
    \\
    &amp;= \frac{1}{N} \mean\Bigl[|\hat{X}_k|^2\Bigr]
\end{split}\]</div>
</div>
<p>This is the discrete version of the Wiener–Khinchin theorem <span id="id1">[<a class="reference internal" href="../references.html#id44" title="A.V. Oppenheim, R.W. Schafer, and J.R. Buck. Discrete-time Signal Processing. Prentice Hall, 1999. ISBN 9780137549207.">OSB99</a>]</span>.</p>
<p>By combining the previous two results,
we can write the covariance of the Fourier transform of the input sequence as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \cov[\hat{X}^*_k \,,\, \hat{X}_\ell]
    = \delta_{k,\ell} \mean\Bigl[|\hat{X}_k|^2\Bigr]
    = N \delta_{k,\ell} C_k
\]</div>
</div>
<p>For the real component of <span class="math notranslate nohighlight">\(\hat{X}_k\)</span> <span class="math notranslate nohighlight">\((=\hat{X}^*_{-k})\)</span>, we find:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \var[\Re (\hat{X}_k)]
    &amp;= \frac{1}{4}\var[\hat{X}_k + \hat{X}^*_k]
    \\
    &amp;= \frac{1}{4}\Bigl(
        \cov[\hat{X}_k \,,\, \hat{X}_k]
        + \cov[\hat{X}_k \,,\, \hat{X}^*_k]
        + \cov[\hat{X}^*_k \,,\, \hat{X}_k]
        + \cov[\hat{X}^*_k \,,\, \hat{X}^*_k]
    \Bigr)
    \\
    &amp;= \frac{1}{4}\Bigl(
        \cov[\hat{X}^*_{-k} \,,\, \hat{X}_k]
        + \cov[\hat{X}_k \,,\, \hat{X}^*_k]
        + \cov[\hat{X}^*_k \,,\, \hat{X}_k]
        + \cov[\hat{X}^*_k \,,\, \hat{X}_{-k}]
    \Bigr)
    \\
    &amp;= \begin{cases}
        N C_0 &amp; \text{if } k=0 \\
        \frac{N}{2} C_k &amp; \text{if } 0&lt;k&lt;N
    \end{cases}
\end{split}\]</div>
</div>
<p>Similarly, for the imaginary component (which is zero for <span class="math notranslate nohighlight">\(k=0\)</span>):</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \var[\Im (\hat{X}_k)]
    &amp;= \frac{1}{4}\var[\hat{X}_k - \hat{X}^*_k]
    \\
    &amp;= \frac{1}{4}\Bigl(
        \cov[\hat{X}_k \,,\, \hat{X}_k]
        - \cov[\hat{X}_k \,,\, \hat{X}^*_k]
        - \cov[\hat{X}^*_k \,,\, \hat{X}_k]
        + \cov[\hat{X}^*_k \,,\, \hat{X}^*_k]
    \Bigr)
    \\
    &amp;= \begin{cases}
        0 &amp; \text{if } k=0 \\
        \frac{N}{2} C_k &amp; \text{if } 0&lt;k&lt;N
    \end{cases}
\end{split}\]</div>
</div>
<p>The real and imaginary components have no covariance:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \cov[\Re (\hat{X}_k)\,,\Im (\hat{X}_k)]
    &amp;= \frac{1}{4}\cov[\hat{X}_k + \hat{X}^*_k \,,\, \hat{X}_k - \hat{X}^*_k]
    \\
    &amp;= \frac{1}{4}\Bigl(
        \cov[\hat{X}_k \,,\, \hat{X}_k]
        - \cov[\hat{X}_k \,,\, \hat{X}^*_k]
    \\
    &amp;\qquad\qquad + \cov[\hat{X}^*_k \,,\, \hat{X}_k]
        - \cov[\hat{X}^*_k \,,\, \hat{X}^*_k]
        \Bigr)
    \\
    &amp;= 0
\end{split}\]</div>
</div>
<p>In summary, the Fourier transform of a stationary stochastic process
consists of uncorrelated real and imaginary components at each frequency.
Furthermore, the variance of the Fourier transform is proportional to the power spectrum.
This simple statistical structure makes the spectrum a convenient starting point
for further analysis and uncertainty quantification.
In comparison, the ACF has non-trivial correlated uncertainties
<span id="id2">[<a class="reference internal" href="../references.html#id51" title="M. S. Bartlett. Introduction to Stochastic Processes With Special Reference to Methods and Applications. Cambridge University Press, 1980. ISBN 9780521215855.">Bar80</a>, <a class="reference internal" href="../references.html#id17" title="Georgi N. Boshnakov. Bartlett's formulae—closed forms and recurrent equations. Ann. Inst. Stat. Math., 48(1):49–59, 1996. doi:10.1007/bf00049288.">Bos96</a>, <a class="reference internal" href="../references.html#id26" title="Christian Francq and Jean-Michel Zakoïan. Bartlett's formula for a general class of nonlinear processes. J. Time Analysis, 30(4):449–465, 2009. doi:10.1111/j.1467-9892.2009.00623.x.">FZ09</a>]</span>,
making it difficult to fit models directly to the ACF (or its running integral).</p>
<p>If we further assume that the sequence <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span> is the result of a periodic Gaussian process,
the Fourier transform is normally distributed.
In this case, the empirical power spectrum follows a scaled Chi-squared distribution
<span id="id3">[<a class="reference internal" href="../references.html#id32" title="Loris Ercole, Aris Marcolongo, and Stefano Baroni. Accurate thermal conductivities from optimally short molecular dynamics simulations. Sci. Rep., 7:15835, 2017. doi:10.1038/s41598-017-15843-2.">EMB17</a>, <a class="reference internal" href="../references.html#id46" title="W.A. Fuller. Introduction to Statistical Time Series. Wiley, 1995. ISBN 9780471552390.">Ful95</a>, <a class="reference internal" href="../references.html#id45" title="M B Priestley. Spectral analysis and time series, two-volume set: Volume 1-2. Academic Press, October 1982. ISBN 9780125649223.">Pri82</a>, <a class="reference internal" href="../references.html#id47" title="R.H. Shumway and D.S. Stoffer. Time Series Analysis and Its Applications: With R Examples. Springer International Publishing, 2017. ISBN 9783319524528.">SS17</a>]</span>.
For notational consistency, we will use the
<a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution"><span class="math notranslate nohighlight">\(\gdist(\alpha,\theta)\)</span> distribution</a>
with shape parameter <span class="math notranslate nohighlight">\(\alpha\)</span> and scale parameter <span class="math notranslate nohighlight">\(\theta\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \hat{C}_0=\frac{1}{N}|\hat{X}_0|^2
    &amp;\sim \gdist(\textstyle\frac{1}{2},2C_0)
    \\
    \hat{C}_{N/2}=\frac{1}{N}|\hat{X}_{N/2}|^2
    &amp;\sim \gdist(\textstyle\frac{1}{2},2C_{N/2})
    \quad \text{if $N$ is even}
    \\
    \hat{C}_k=\frac{1}{N}|\hat{X}_k|^2
    &amp;\sim \gdist(1,C_k)
    \quad \text{for } 0&lt;k&lt;N \text { and } k \neq N/2
\end{split}\]</div>
</div>
<p>Note that <span class="math notranslate nohighlight">\(\hat{X}_0\)</span> and <span class="math notranslate nohighlight">\(\hat{X}_{N/2}\)</span> have only a real component
because the input sequence <span class="math notranslate nohighlight">\(\hat{\mathbf{x}}\)</span> is real,
which corresponds to a Chi-squared distribution with one degree of freedom.
For all other frequencies, <span class="math notranslate nohighlight">\(\hat{X}_k\)</span> has a real and imaginary component,
resulting in two degrees of freedom.</p>
<p>Spectra are often computed by averaging them over <span class="math notranslate nohighlight">\(M\)</span> sequences to reduce the variance.
In this case, the <span class="math notranslate nohighlight">\(M\)</span>-averaged empirical spectrum is distributed as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \hat{C}_k=\frac{1}{NM}\sum_{s=1}^M|\hat{X}^s_0|^2
    \sim \gdist(\textstyle\frac{\nu_k}{2},\textstyle\frac{2}{\nu_k}C_k)
\]</div>
</div>
<p>with</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \nu_k = \begin{cases}
        M &amp; \text{if $k=0$} \\
        M &amp; \text{if $k=N/2$ and $N$ is even} \\
        2M &amp; \text{otherwise}
    \end{cases}
\end{split}\]</div>
</div>
<p>The rescaled spectrum used in STACIE, <span class="math notranslate nohighlight">\(\hat{I}_k\)</span>, has the same distribution,
except for the scale parameter:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \hat{I}_k = \frac{F h}{2} \hat{C}_k
    \sim \gdist(\textstyle\frac{\nu_k}{2},\textstyle\frac{2}{\nu_k}I_k)
\]</div>
</div>
</section>
<section id="regression">
<span id="lmax-target"></span><h2>Regression<a class="headerlink" href="#regression" title="Link to this heading">¶</a></h2>
<p>To identify the low-frequency part of the spectrum,
we introduce a smooth switching function that goes from 1 to 0 as the frequency increases:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    w(f_k|f_\text{cut}) = \frac{1}{1 + (f_k/f_\text{cut})^\beta}
\]</div>
</div>
<p>This switching function is <span class="math notranslate nohighlight">\(1/2\)</span> when <span class="math notranslate nohighlight">\(f_k=f_\text{cut}\)</span>.
The hyperparameter <span class="math notranslate nohighlight">\(\beta\)</span> controls the steepness of the transition and is 8 by default.
(This should be fine for most applications.)
This value can be set with the <code class="docutils literal notranslate"><span class="pre">switch_exponent</span></code> argument
of the <a class="reference internal" href="../apidocs/stacie.estimate.html#stacie.estimate.estimate_acint" title="stacie.estimate.estimate_acint"><span class="xref myst py py-func">estimate_acint()</span></a> function.
One can better appreciate the advantage of this switching function by rewriting with a hyperbolic tangent:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    w(f_k|f_\text{cut}) = \frac{1}{2}\left[
        1 - \tanh\left(\frac{\beta}{2}\ln\frac{f_k}{f_\text{cut}}\right)
    \right]
\]</div>
</div>
<p>This shows that the switching is scale invariant, i.e., it does not depend on the unit of the frequency,
because the frequency appears only in a logarithm.
The parameter <span class="math notranslate nohighlight">\(\beta\)</span> controls the width of the transition region on a logarithmic scale.</p>
<p>We derive below how to fit parameters for a given frequency cut-off <span class="math notranslate nohighlight">\(f_\text{cut}\)</span>.
The <a class="reference internal" href="cutoff.html"><span class="std std-doc">next section</span></a> describes how to find suitable cutoffs.</p>
<p>To fit the model, we use a form of local regression
by introducing weights into the log-likelihood function.
The weighted log likelihood of the model <span class="math notranslate nohighlight">\(I^\text{model}_k(\mathbf{b})\)</span>
with parameter vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> becomes:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \ln\mathcal{L}(\mathbf{b})
    &amp;=\sum_{k\in K} w(f_k|f_\text{cut}) \ln p_{\gdist(\alpha_k,\theta_k)}(\hat{C}_k)
    \\
    &amp;=\sum_{k\in K}
        w(f_k|f_\text{cut}) \left[
            -\ln \Gamma(\alpha_k)
            - \ln\bigl(\theta_k(\mathbf{b})\bigr)
            + (\alpha_k - 1)\ln\left(\frac{\hat{C}_k}{\theta_k(\mathbf{b})}\right)
            - \frac{\hat{C}_k}{\theta_k(\mathbf{b})}
        \right]
\end{split}\]</div>
</div>
<p>with</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \alpha_k &amp;= \frac{\nu_k}{2}
    \\
    \theta_k(\mathbf{b}) &amp;= \frac{2 I^\text{model}_k(\mathbf{b})}{\nu_k}
\end{split}\]</div>
</div>
<p>This log-likelihood is maximized to estimate the model parameters.
The zero-frequency limit of the fitted model is then the estimate of the autocorrelation integral.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is worth mentioning that the cutoff frequency is not a proper hyperparameter in the Bayesian sense.
It appears in the weight factor <span class="math notranslate nohighlight">\(w(f_k|f_\text{cut})\)</span>, which is not part of the model.
Instead, it is a concept taken from local regression methods.
One conceptual limitation of this approach is that the unit of the likelihood function,
<span class="math notranslate nohighlight">\(\mathcal{L}(\mathbf{b})\)</span>, depends on the cutoff frequency.
As a result, one cannot compare the likelihood of two different cutoffs.
This is of little concern when fitting parameters for a fixed cutoff,
but it is important to keep in mind when searching for suitable cutoffs.</p>
</div>
<p>For compatibility with the SciPy optimizers,
the cost function <span class="math notranslate nohighlight">\(\operatorname{cost}(\mathbf{b}) = -\ln \mathcal{L}(\mathbf{b})\)</span> is minimized.
STACIE implements first and second derivatives of <span class="math notranslate nohighlight">\(\operatorname{cost}(\mathbf{b})\)</span>,
and also a good initial guess of the parameters, using efficient vectorized NumPy code.
These features make the optimization of the parameters both efficient and reliable.
The optimized parameters are denoted as <span class="math notranslate nohighlight">\(\hat{\mathbf{b}}\)</span>.
The hats indicate that these are statistical estimates because
they are derived from data statistical uncertainties.</p>
<p>The Hessian computed with the estimated parameters, <span class="math notranslate nohighlight">\(\operatorname{cost}(\hat{\mathbf{b}})\)</span>,
must be positive definite.
(If non-positive eigenvalues are found, the optimization is treated as failed.)</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \hat{\mathbf{H}} &gt; 0 \quad \text{with}
    \quad
    \hat{H}_{ij} =
        \left.
        \frac{\partial^2 \operatorname{cost}}{\partial b_i \partial b_j}
        \right|_{\mathbf{b}=\hat{\mathbf{b}}}
\]</div>
</div>
<p>The estimated covariance matrix of the estimated parameters
is approximated by the inverse of the Hessian,
which can be justified with the Laplace approximation:
<span id="id4">[<a class="reference internal" href="../references.html#id48" title="David J.C. MacKay. Information Theory, Inference and Learning Algorithms. Cambridge University Press, 2005. ISBN 9780521642989.">Mac05</a>]</span>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \hat{C}_{\hat{b}_i,\hat{b}_j} = \bigl(\hat{\mathbf{H}}^{-1}\bigr)_{ij}
\]</div>
</div>
<p>This covariance matrix characterizes the uncertainties of the model parameters
and thus also of the autocorrelation integral.
More accurate covariance estimates can be obtained with Monte Carlo sampling,
but this is not implemented in STACIE.
Note that this covariance only accounts for the uncertainty due to noise in the spectrum,
which is acceptable if the cutoff frequency is a fixed value.
However, in STACIE, the cutoff frequency is also fitted,
meaning that the uncertainty due to the cutoff must also be accounted for.
This will be discussed in the <a class="reference internal" href="cutoff.html"><span class="std std-doc">next section</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The estimated covariance has no factor <span class="math notranslate nohighlight">\(N_\text{fit}/(N_\text{fit} - N_\text{par})\)</span>,
where <span class="math notranslate nohighlight">\(N_\text{fit}\)</span> is the amount of data in the fit and <span class="math notranslate nohighlight">\(N_\text{par}\)</span> is the number of parameters.
This factor is specific to the case of (non)linear regression with normal deviates
of which the standard deviation is not known <em>a priori</em> <span id="id5">[<a class="reference internal" href="../references.html#id27" title="Russel B. Millar. Maximum Likelihood Estimation and Inference With Examples in R, SAS and ADMB. John Wiley &amp; Sons, 2011. ISBN 978-0-470-09482-2.">Mil11</a>]</span>.
Here, the amplitudes are Gamma-distributed with a known shape parameter.
Only the scale parameter at each frequency is predicted by the model.</p>
</div>
</section>
<section id="regression-cost-z-score">
<h2>Regression Cost Z-score<a class="headerlink" href="#regression-cost-z-score" title="Link to this heading">¶</a></h2>
<p>When a model is too simple to explain the data,
the regression cost <a class="reference external" href="https://en.wikipedia.org/wiki/Standard_score">Z-score</a>
can be used to quantify the goodness of fit.
This is implemented in STACIE to facilitate the detection of poorly fitted models,
which can sometimes occur if the selected model cannot explain the data for any cutoff frequency.
This Z-score is defined as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    Z_\text{cost}(\mathbf{b}) = \frac{
        \operatorname{cost}(\mathbf{b}) - \mean\left[\hat{\operatorname{cost}}(\mathbf{b})\right]
    }{
        \std\left[\hat{\operatorname{cost}}(\mathbf{b})\right]
    }
\]</div>
</div>
<p>The mean <span class="math notranslate nohighlight">\(\mean\left[\hat{\operatorname{cost}}(\mathbf{b})\right]\)</span>
and standard deviation <span class="math notranslate nohighlight">\(\std\left[\hat{\operatorname{cost}}(\mathbf{b})\right]\)</span>
are computed as expectation values over all possible spectra sampled
from the Gamma distribution corresponding to the model parameters <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.
For both expectation values STACIE implements computationally efficient closed-form solutions.</p>
<p>The Z-score is easily interpretable as a goodness of fit measure.
When the model fits the data well, the Z-score has a zero mean and unit standard deviation.
When the model is too simple and underfits the data,
the Z-score is positive and quickly exceeds the standard deviation.
For example a Z-score of 2 indicates that the model cost is two standard deviations above its mean,
suggesting that the model is too simple.</p>
<p>The mean is derived as follows:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \mean\left[\hat{\operatorname{cost}}(\mathbf{b})\right]
    = \sum_{k\in K}
        w(f_k|f_\text{cut})
        \mean\left[-\ln p_{\gdist(\alpha_k,\theta_k)}(\hat{C}_k)\right]
\]</div>
</div>
<p>where the mean is computed by sampling <span class="math notranslate nohighlight">\(\hat{C}_k\)</span> from the distribution
<span class="math notranslate nohighlight">\(\gdist(\alpha_k,\theta_k)\)</span>.
This mean is also known as the entropy of the distribution,
with a well-known closed-form solution.
Inserting this solution into the previous equation gives:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \mean\left[\hat{\operatorname{cost}}(\mathbf{b})\right]
    = \sum_{k\in K}
        w(f_k|f_\text{cut})
        \Bigl(
            \alpha_k
            - \ln\bigl(\theta_k(\mathbf{b})\bigr)
            + \ln \Gamma(\alpha_k)
            + (1 - \alpha_k)\psi(\alpha_k)
        \Bigr)
\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\psi(\alpha)\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Digamma_function">digamma</a> function.</p>
<p>The standard deviation is best derived by first computing the variance of the cost function:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \var\left[\hat{\operatorname{cost}}(\mathbf{b})\right]
    = \sum_{k\in K}
        w(f_k|f_\text{cut})^2
        \var\left[-\ln p_{\gdist(\alpha_k,\theta_k)}(\hat{C}_k)\right]
\]</div>
</div>
<p>The variance of the cost function is also defined as an expectation value
over <span class="math notranslate nohighlight">\(\hat{C}_k\)</span> from the distribution <span class="math notranslate nohighlight">\(\gdist(\alpha_k,\theta_k)\)</span>.
This variance can also be derived analytically, but the result is not as well-known,
so we will work it out here.
The logarithm of the probability density has only two terms that depend on the random variable <span class="math notranslate nohighlight">\(\hat{C}_k\)</span>,
which are relevant for the variance:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{aligned}
        &amp;\hspace{-1em}\var\left[-\ln p_{\gdist(\alpha_k,\theta_k)}(\hat{C}_k)\right]
        \\
        &amp;= \var\left[
            (\alpha_k - 1)\ln(\hat{C}_k)
            - \frac{\hat{C}_k}{\theta_k(\mathbf{b})}
        \right]
        \\
        &amp;= (\alpha_k - 1)^2 \var\left[\ln(\hat{C}_k)\right]
            + \frac{1}{\theta_k^2(\mathbf{b})} \var\left[\hat{C}_k\right]
            - 2\frac{\alpha_k - 1}{\theta_k(\mathbf{b})} \cov\left[\ln(\hat{C}_k),\hat{C}_k\right]
    \end{aligned}
\end{split}\]</div>
</div>
<p>The first two terms are well-known results,
i.e. <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution#Properties">the variance of the log-Gamma and Gamma distributions</a>,
respectively.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{aligned}
        \var\left[\ln(\hat{C}_k)\right] &amp;= \psi_1(\alpha_k)
        \\
        \var\left[\hat{C}_k\right] &amp;= \alpha_k\, \theta_k^2(\mathbf{b})
    \end{aligned}
\end{split}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\psi_1(\alpha)\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Trigamma_function">trigamma</a> function.
The only term that requires some more work is the third term:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \cov\left[\ln(\hat{C}_k),\hat{C}_k\right]
    = \mean\left[\ln(\hat{C}_k)\,\hat{C}_k\right]
      - \mean\left[\ln(\hat{C}_k)\right]\,\mean\left[\hat{C}_k\right]
\]</div>
</div>
<p>A <a class="reference external" href="https://statproofbook.github.io/P/gam-xlogx">derivation of the first term</a> can be found in the
wonderful online <a class="reference external" href="https://statproofbook.github.io/">book of statistical proofs</a>.
The second term contains well-known <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution#Properties">expectation values of the Gamma distribution</a>.
The results are:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{aligned}
        \mean\left[\ln(\hat{C}_k)\,\hat{C}_k\right]
        &amp;= \alpha_k\,\theta_k(\mathbf{b})
           \Bigl(\psi(\alpha_k+1) + \ln\bigl(\theta_k(\mathbf{b})\bigr)\Bigr)
        \\
        \mean\left[\ln(\hat{C}_k)\right]
        &amp;= \psi(\alpha_k) + \ln\bigl(\theta_k(\mathbf{b})\bigr)
        \\
        \mean\left[\hat{C}_k\right]
        &amp;= \alpha_k\, \theta_k(\mathbf{b})
    \end{aligned}
\end{split}\]</div>
</div>
<p>The covariance can now be worked out by making using of the
<a class="reference external" href="https://en.wikipedia.org/wiki/Digamma_function#Recurrence_formula_and_characterization">well-known recurrence relation of the digamma function</a>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{aligned}
        \cov\left[\ln(\hat{C}_k),\hat{C}_k\right]
        &amp;= \alpha_k\,\theta_k(\mathbf{b})
           \bigl(\psi(\alpha_k+1) - \psi(\alpha_k)\bigr)
        \\
        &amp;= \theta_k(\mathbf{b})
    \end{aligned}
\end{split}\]</div>
</div>
<p>Putting it all together,
we find the variance of the logarithm of the probability density of the Gamma distribution:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \var\left[-\ln p_{\gdist(\alpha_k,\theta_k)}(\hat{C}_k)\right]
    = (\alpha_k - 1)^2 \psi_1(\alpha_k) - \alpha_k + 2
\]</div>
</div>
<p>The standard devation in the Z-score finally becomes:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
    \std\left[\hat{\operatorname{cost}}(\mathbf{b})\right]
    = \sqrt{\sum_{k\in K}
        w(f_k|f_\text{cut})^2
        \Bigl(
            (\alpha_k - 1)^2 \psi_1(\alpha_k) - \alpha_k + 2
        \Bigr)
    }
\]</div>
</div>
<p>It is noteworthy that the standard deviation is independent of the model parameters <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="cutoff.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Frequency Cutoff</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="model.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Model Spectrum</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024--2026, Gözdenur Toraman, Toon Verstraelen
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://molmod.ugent.be" aria-label="Center for Molecular Modeling"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
<path d="M 8,0.23203771 1.2708502,4.1166743 V 7.586584 H 2.0757403 V 4.5814695 L 8,1.1606847 13.924259,4.5814695 V 7.586584 h 0.80489 V 4.1166743 Z" />
<path d="m 8,3.6329842 c -2.4076366,0 -4.3683267,1.9606901 -4.3683267,4.368326 0,1.0499591 0.3736113,2.0145218 0.9938323,2.7689368 L 4.9523743,9.845379 C 4.6268573,9.3073839 4.436564,8.6780482 4.436564,8.0013102 4.436564,6.0283899 6.027079,4.4378742 8,4.4378742 c 1.9729204,0 3.563435,1.5905157 3.563435,3.563436 0,0.676738 -0.190293,1.3060737 -0.515809,1.8440688 l 0.326868,0.924868 c 0.620221,-0.754415 0.993832,-1.7189777 0.993832,-2.7689368 0,-2.4076359 -1.96069,-4.3683267 -4.368326,-4.368326 z" />
<path d="m 4.5647296,15.767884 2.0103367,-5.68462 0.979439,5.684633 0.8166682,-0.0019 L 7.1003242,8.3914521 H 6.3187358 L 4.1855869,14.427689 2.052438,8.3914521 H 1.2708502 L 2e-7,15.765962 l 0.81666821,0.0019 0.97943899,-5.684633 2.0103367,5.68462 z" />
<path d="m 12.193555,15.767884 2.010337,-5.68462 0.979438,5.684633 L 16,15.765962 14.729149,8.3914521 H 13.947561 L 11.814413,14.427689 9.6812637,8.3914521 H 8.8996758 l -1.2708506,7.3745099 0.8166683,0.002 0.9794395,-5.684632 2.010337,5.684619 z" />
</svg></a>
              <a class="muted-link " href="https://www.ugent.be/ea/emsme/en/research/soete" aria-label="Soete Laboratory"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
<path d="M 1.2243149,11.312034 V 0.3537872 c 0,-0.47171662 3.2133726,-0.47171662 3.2133726,0 V 11.275667 c 0.038589,1.391853 0.8362299,2.107621 2.6118885,2.188801 0.3456227,0 0.3456227,2.535532 0,2.535532 -2.5872928,0 -5.8252611,-1.272498 -5.8252611,-4.687966 z" />
<path d="M 9.0151601,16 C 12.286758,15.9977 14.766446,14.194112 14.775658,11.101887 14.784658,8.0882805 12.485826,7.1827295 10.791465,6.4316093 9.6750417,5.9366938 8.1559684,5.3529148 8.1229508,4.0958595 8.089931,2.8388043 9.1956669,2.5059896 10.318156,2.4898791 c 1.24952,-0.017939 2.35918,0.6351356 3.134465,1.0460205 0.333368,0.1766787 0.80108,-1.909061 0.109685,-2.62234708 C 12.969839,0.30232534 11.507764,0.01488162 9.9750266,0.01430271 6.3231448,0.01292984 4.9375194,2.3766199 4.917302,4.4194486 4.894588,6.7146645 6.6302121,8.1331941 8.4220755,8.9015433 c 1.235865,0.5299374 3.0428875,0.956338 3.0526165,2.6331567 0.007,1.208881 -1.112249,1.929768 -2.4595319,1.929768 -0.4639212,0 -0.4729202,2.535532 0,2.535532 z" />
</svg></a>
              <a class="muted-link " href="https://ugent.be" aria-label="Ghent University"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
<path d="M 8.4671319,6.1991107 H 7.5328685 V 12.263022 H 8.4671319 V 6.1991107" />
<path d="M 6.5989047,6.1991107 H 5.6647163 V 12.263022 H 6.5989047 V 6.1991107" />
<path d="M 4.7307525,6.1991107 H 3.7964891 V 12.263022 H 4.7307525 V 6.1991107" />
<path d="M 2.8626002,6.1991107 H 1.9283368 V 12.263022 H 2.8626002 V 6.1991107" />
<path d="M 10.335284,6.1991107 H 9.4010957 V 12.263022 H 10.335284 V 6.1991107" />
<path d="m 12.203511,6.1991107 h -0.934263 v 6.0639113 h 0.934263 V 6.1991107" />
<path d="M 14.071664,6.1991107 H 13.1374 v 6.0639113 h 0.934264 V 6.1991107" />
<path d="M 15.028173,14.131773 H 0.97182731 V 13.196985 H 15.028173 v 0.934788" />
<path d="M 14.071664,5.2648473 H 1.9283368 L 0.99437307,4.3309584 H 15.005627 l -0.933963,0.9338889" />
<path d="M 15.962062,16 H 0.03793844 V 15.065138 H 15.962062 V 16" />
<path d="M 15.962062,2.8200179 7.9998879,7.5076002e-8 0.03793844,2.8200179 V 3.8118816 L 7.9998879,0.99246298 15.962062,3.8118816 V 2.8200179" />
</svg></a>
              <a class="muted-link " href="https://github.com/molmod/stacie" aria-label="GitHub"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
<path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
</svg></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Parameter Estimation</a><ul>
<li><a class="reference internal" href="#statistics-of-the-sampling-power-spectral-distribution">Statistics of the Sampling Power Spectral Distribution</a></li>
<li><a class="reference internal" href="#regression">Regression</a></li>
<li><a class="reference internal" href="#regression-cost-z-score">Regression Cost Z-score</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=61243dd2"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script defer="defer" src="https://unpkg.com/@popperjs/core@2"></script>
    <script defer="defer" src="https://unpkg.com/tippy.js@6"></script>
    <script defer="defer" src="../_static/tippy/theory/statistics.0d7d9b50-513b-4a0c-a6f3-d9ac71359f79.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"mean": "\\operatorname{E}", "var": "\\operatorname{VAR}", "std": "\\operatorname{STD}", "cov": "\\operatorname{COV}", "gdist": "\\operatorname{Gamma}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>