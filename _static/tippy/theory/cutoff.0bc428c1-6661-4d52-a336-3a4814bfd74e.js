selector_to_html = {"a[href=\"https://en.wikipedia.org/wiki/Mixture_distribution\"]": "<p>In probability and statistics, a <b>mixture distribution</b> is the probability distribution of a random variable that is derived from a collection of other random variables as follows: first, a random variable is selected by chance from the collection according to given probabilities of selection, and then the value of the selected random variable is realized. The underlying random variables may be random real numbers, or they may be random vectors, in which case the mixture distribution is a multivariate distribution.</p>", "a[href^=\"https://en.wikipedia.org/wiki/Mixture_distribution#\"]": "<p>In probability and statistics, a <b>mixture distribution</b> is the probability distribution of a random variable that is derived from a collection of other random variables as follows: first, a random variable is selected by chance from the collection according to given probabilities of selection, and then the value of the selected random variable is realized. The underlying random variables may be random real numbers, or they may be random vectors, in which case the mixture distribution is a multivariate distribution.</p>", "a[href=\"statistics.html\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\">Parameter Estimation<a class=\"headerlink\" href=\"#parameter-estimation\" title=\"Link to this heading\">\u00b6</a></h1><p>Before discussing how to fit a model to spectral data,\nwe first review the statistics of the sampling <a class=\"reference internal\" href=\"../glossary.html#term-PSD\"><span class=\"xref std std-term\">PSD</span></a>.\nGiven these statistical properties,\nwe can derive the likelihood that certain model parameters explain the observed PSD.</p>", "a[href=\"model.html\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\">Model Spectrum<a class=\"headerlink\" href=\"#model-spectrum\" title=\"Link to this heading\">\u00b6</a></h1><p>STACIE supports three models for fitting the low-frequency part of the power spectrum.\nIn both models, the value at zero frequency corresponds to the autocorrelation integral.</p>", "a[href=\"../glossary.html#term-ACF\"]": "<dt id=\"term-ACF\">ACF</dt><dd><p>Autocorrelation function.\nA measure of the correlation of a signal with itself at different time lags.</p></dd>", "a[href=\"#frequency-cutoff\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\">Frequency Cutoff<a class=\"headerlink\" href=\"#frequency-cutoff\" title=\"Link to this heading\">\u00b6</a></h1><p>In STACIE, a model is fitted to the low-frequency part of the sampling <a class=\"reference internal\" href=\"../glossary.html#term-PSD\"><span class=\"xref std std-term\">PSD</span></a>.\nThis low-frequency part is defined by a cutoff frequency, <span class=\"math notranslate nohighlight\">\\(f_{\\text{cut}}\\)</span>,\nabove which the model is not expected to explain the data.\nThe <a class=\"reference internal\" href=\"statistics.html\"><span class=\"std std-doc\">previous section</span></a> discussed how to implement a local regression\nusing a smooth switching function parameterized by such a cutoff frequency, <span class=\"math notranslate nohighlight\">\\(f_\\text{cut}\\)</span>.\nA good choice for the cutoff seeks a trade-off between two conflicting goals:</p>", "a[href=\"#effective-number-of-fitting-points\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Effective number of fitting points<a class=\"headerlink\" href=\"#effective-number-of-fitting-points\" title=\"Link to this heading\">\u00b6</a></h2><p>The concept of \u201ceffective number of fitting points\u201d is used regularly in the following subsections.\nFor a given cutoff frequency, it is defined as:</p>", "a[href=\"statistics.html#regression\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Regression<a class=\"headerlink\" href=\"#regression\" title=\"Link to this heading\">\u00b6</a></h2><p>To identify the low-frequency part of the spectrum,\nwe introduce a smooth switching function that goes from 1 to 0 as the frequency increases:</p>", "a[href=\"#grid-of-cutoff-frequencies\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Grid of Cutoff Frequencies<a class=\"headerlink\" href=\"#grid-of-cutoff-frequencies\" title=\"Link to this heading\">\u00b6</a></h2><p>STACIE uses a logarithmic grid of cutoff frequencies and fits model parameters for each cutoff.\nThe grid is defined as:</p>", "a[href=\"../glossary.html#term-Uncertainty\"]": "<dt id=\"term-Uncertainty\">Uncertainty</dt><dd><p>An estimate of the standard deviation of a result\nif the analysis would have been repeated many times with independent inputs.\nThis is also known as the standard error.</p></dd>", "a[href=\"#cross-validation\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Cross-Validation<a class=\"headerlink\" href=\"#cross-validation\" title=\"Link to this heading\">\u00b6</a></h2><p>Given a cutoff frequency, <span class=\"math notranslate nohighlight\">\\(f_{\\text{cut},j}\\)</span>,\nSTACIE estimates model parameters <span class=\"math notranslate nohighlight\">\\(\\hat{\\mathbf{b}}^{(j)}\\)</span>\nand their covariance matrix <span class=\"math notranslate nohighlight\">\\(\\hat{\\mathbf{C}}_{\\mathbf{b}^{(j)},\\mathbf{b}^{(j)}}\\)</span>.\nTo quantify the degree of over- or underfitting,\nthe model parameters are further refined\nby fitting them to the first and second halves of the low-frequency part of the sampling PSD.\nTo make these refinements robust, the two halves are defined using smooth switching functions:</p>", "a[href=\"../apidocs/stacie.cutoff.html#stacie.cutoff.CV2LCriterion\"]": "<dt class=\"sig sig-object py\" id=\"stacie.cutoff.CV2LCriterion\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-name descname\"><span class=\"pre\">CV2LCriterion</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fcut_factor</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">1.25</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">log</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">False</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">cond</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">1000000.0</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">precondition</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">regularize</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em><span class=\"sig-paren\">)</span><a class=\"reference internal\" href=\"../_modules/stacie/cutoff.html#CV2LCriterion\"><span class=\"viewcode-link\"><span class=\"pre\">[source]</span></span></a></dt><dd><p>Bases: <a class=\"reference internal\" href=\"#stacie.cutoff.CutoffCriterion\" title=\"stacie.cutoff.CutoffCriterion\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">CutoffCriterion</span></code></a></p><p>Criterion based on the difference between fits to two halves of the spectrum.</p></dd>", "a[href=\"../apidocs/stacie.cutoff.html#stacie.cutoff.linear_weighted_regression\"]": "<dt class=\"sig sig-object py\" id=\"stacie.cutoff.linear_weighted_regression\">\n<span class=\"sig-name descname\"><span class=\"pre\">linear_weighted_regression</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">dm</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">ev</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">ws</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">lc</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">ridge</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">0.0</span></span></em><span class=\"sig-paren\">)</span><a class=\"reference internal\" href=\"../_modules/stacie/cutoff.html#linear_weighted_regression\"><span class=\"viewcode-link\"><span class=\"pre\">[source]</span></span></a></dt><dd><p>Perform a linear regression with multiple weight vectors.</p><p>This is a helper function for cv2l_criterion.</p></dd>", "a[href=\"#cutoff-criterion-z-score\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Cutoff Criterion Z-score<a class=\"headerlink\" href=\"#cutoff-criterion-z-score\" title=\"Link to this heading\">\u00b6</a></h2><p>In the far majority of cases, the cutoff criterion will be dominated by the bias term:\nit typically increases steeply as soon as the model underfits the data.\nIn contrast, the variance term decreases relatively slowly.\nAs a result, the minimum of the cutoff criterion is well-defined at the onset of underfitting.\nThis works particularly well when the spectrum can be computed with a high frequency resolution.\nUnfortunately, there are cases where this ideal pattern does not hold,\nusually when providing too little data to STACIE,\nin which the cutoff criterion exhibits statistical fluctuations.\nTo detect such ill-constrained cases, STACIE computes a Z-score for the cutoff criterion.\nThis Z-score is defined as in the same spirit as the Regression Cost Z-score,\nbut now using <span class=\"math notranslate nohighlight\">\\(\\operatorname{criterion}^\\text{CV2L}\\)</span> instead of the regression cost function.</p><p>The cutoff criterion Z-score is defined as:</p>", "a[href=\"../glossary.html#term-PSD\"]": "<dt id=\"term-PSD\">PSD</dt><dd><p>Power spectral density.\nA measure of the power of a signal as a function of frequency.\nThe Fourier transform of the autocorrelation function.</p></dd>", "a[href=\"#marginalization-over-the-cutoff-frequency\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\">Marginalization Over the Cutoff Frequency<a class=\"headerlink\" href=\"#marginalization-over-the-cutoff-frequency\" title=\"Link to this heading\">\u00b6</a></h2><p>Any method to deduce the cutoff frequency from the spectrum,\nwhether it is human judgment or an automated algorithm,\nintroduces some <a class=\"reference internal\" href=\"../glossary.html#term-Uncertainty\"><span class=\"xref std std-term\">uncertainty</span></a> in the final result\nbecause the cutoff is based on a sampling PSD spectrum with statistical uncertainty.</p><p>In STACIE, this uncertainty is accounted for\nby marginalizing the model parameters over the cutoff frequency,\nusing <span class=\"math notranslate nohighlight\">\\(\\mathcal{L}^\\text{CV2L}\\)</span> as a model for the likelihood.\nThis approach naturally incorporates the uncertainty in the cutoff frequency\nand is preferred over fixing the cutoff frequency at a single value.</p>", "a[href=\"../apidocs/stacie.estimate.html#stacie.estimate.estimate_acint\"]": "<dt class=\"sig sig-object py\" id=\"stacie.estimate.estimate_acint\">\n<span class=\"sig-name descname\"><span class=\"pre\">estimate_acint</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">spectrum</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">model</span></span></em>, <em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">neff_min</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">neff_max</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">1000</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fcut_min</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fcut_max</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fcut_spacing</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">0.5</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">switch_exponent</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">8.0</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">cutoff_criterion</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">rng</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">nonlinear_budget</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">100</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">criterion_high</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">100</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">verbose</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">False</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">uc</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"reference internal\" href=\"../_modules/stacie/estimate.html#estimate_acint\"><span class=\"viewcode-link\"><span class=\"pre\">[source]</span></span></a></dt><dd><p>Estimate the integral of the autocorrelation function.</p><p>It is recommended to leave the keyword arguments to their default values,\nexcept for methodological testing.</p><p>This function fits a model to the low-frequency portion of the spectrum and\nderives an estimate of the autocorrelation (and its uncertainty) from the fit.\nIt repeats this for a range of cutoff frequencies on a logarithmic grid.\nFinally, an ensemble average over all cutoffs is computed,\nby using <code class=\"docutils literal notranslate\"><span class=\"pre\">-np.log</span></code> of the cutoff criterion as weight.</p><p>The cutoff frequency grid is logarithmically spaced,\nwith the ratio between two successive cutoff frequencies given by</p><p>where <span class=\"math notranslate nohighlight\">\\(g_\\text{sp}\\)</span> is <code class=\"docutils literal notranslate\"><span class=\"pre\">fcut_spacing</span></code> and <span class=\"math notranslate nohighlight\">\\(\\beta\\)</span> is <code class=\"docutils literal notranslate\"><span class=\"pre\">switch_exponent</span></code>.</p></dd>"}
skip_classes = ["headerlink", "sd-stretched-link"]

window.onload = function () {
    for (const [select, tip_html] of Object.entries(selector_to_html)) {
        const links = document.querySelectorAll(` ${select}`);
        for (const link of links) {
            if (skip_classes.some(c => link.classList.contains(c))) {
                continue;
            }

            tippy(link, {
                content: tip_html,
                allowHTML: true,
                arrow: true,
                placement: 'auto-start', maxWidth: 500, interactive: false,

            });
        };
    };
    console.log("tippy tips loaded!");
};
