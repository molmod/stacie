<!DOCTYPE html>

<html class="no-js" data-content_root="../" lang="en">
<head><meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="light dark" name="color-scheme"/><meta content="width=device-width, initial-scale=1" name="viewport">
<link href="../genindex.html" rel="index" title="Index"/><link href="../search.html" rel="search" title="Search"/><link href="molten_salt.html" rel="next" title="Ionic Electrical Conductivity of Molten Sodium Chloride at 1100 K (OpenMM)"/><link href="lj_bulk_viscosity.html" rel="prev" title="Bulk Viscosity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)"/>
<link href="../_static/stacie-logo-black.svg" rel="shortcut icon"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
<title>Thermal Conductivity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS) - STACIE 1.0</title>
<link href="../_static/pygments.css?v=8f2a1f02" rel="stylesheet" type="text/css"/>
<link href="../_static/styles/furo.css?v=354aac6f" rel="stylesheet" type="text/css"/>
<link href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-codeautolink.css?v=b2176991" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/styles/furo-extensions.css?v=302659d7" rel="stylesheet" type="text/css"/>
<link href="../_static/custom.css?v=d923d65c" rel="stylesheet" type="text/css"/>
<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-title-font-size: 1rem;
  --admonition-font-size: 1rem;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-title-font-size: 1rem;
  --admonition-font-size: 1rem;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-title-font-size: 1rem;
  --admonition-font-size: 1rem;
  
      }
    }
  }
</style></meta></head>
<body>
<script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<symbol id="svg-toc" viewbox="0 0 24 24">
<title>Contents</title>
<svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 1024 1024">
<path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"></path>
</svg>
</symbol>
<symbol id="svg-menu" viewbox="0 0 24 24">
<title>Menu</title>
<svg class="feather-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<line x1="3" x2="21" y1="12" y2="12"></line>
<line x1="3" x2="21" y1="6" y2="6"></line>
<line x1="3" x2="21" y1="18" y2="18"></line>
</svg>
</symbol>
<symbol id="svg-arrow-right" viewbox="0 0 24 24">
<title>Expand</title>
<svg class="feather-chevron-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<polyline points="9 18 15 12 9 6"></polyline>
</svg>
</symbol>
<symbol id="svg-sun" viewbox="0 0 24 24">
<title>Light mode</title>
<svg class="feather-sun" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="5"></circle>
<line x1="12" x2="12" y1="1" y2="3"></line>
<line x1="12" x2="12" y1="21" y2="23"></line>
<line x1="4.22" x2="5.64" y1="4.22" y2="5.64"></line>
<line x1="18.36" x2="19.78" y1="18.36" y2="19.78"></line>
<line x1="1" x2="3" y1="12" y2="12"></line>
<line x1="21" x2="23" y1="12" y2="12"></line>
<line x1="4.22" x2="5.64" y1="19.78" y2="18.36"></line>
<line x1="18.36" x2="19.78" y1="5.64" y2="4.22"></line>
</svg>
</symbol>
<symbol id="svg-moon" viewbox="0 0 24 24">
<title>Dark mode</title>
<svg class="icon-tabler-moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
</svg>
</symbol>
<symbol id="svg-sun-with-moon" viewbox="0 0 24 24">
<title>Auto light/dark, in light mode</title>
<svg class="icon-custom-derived-from-feather-sun-and-tabler-moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z" style="opacity: 50%"></path>
<line x1="14.5" x2="14.5" y1="3.25" y2="1.25"></line>
<line x1="14.5" x2="14.5" y1="15.85" y2="17.85"></line>
<line x1="10.044" x2="8.63" y1="5.094" y2="3.68"></line>
<line x1="19" x2="20.414" y1="14.05" y2="15.464"></line>
<line x1="8.2" x2="6.2" y1="9.55" y2="9.55"></line>
<line x1="20.8" x2="22.8" y1="9.55" y2="9.55"></line>
<line x1="10.044" x2="8.63" y1="14.006" y2="15.42"></line>
<line x1="19" x2="20.414" y1="5.05" y2="3.636"></line>
<circle cx="14.5" cy="9.55" r="3.6"></circle>
</svg>
</symbol>
<symbol id="svg-moon-with-sun" viewbox="0 0 24 24">
<title>Auto light/dark, in dark mode</title>
<svg class="icon-custom-derived-from-feather-sun-and-tabler-moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"></path>
<line style="opacity: 50%" x1="18" x2="18" y1="3.705" y2="2.5"></line>
<line style="opacity: 50%" x1="18" x2="18" y1="11.295" y2="12.5"></line>
<line style="opacity: 50%" x1="15.316" x2="14.464" y1="4.816" y2="3.964"></line>
<line style="opacity: 50%" x1="20.711" x2="21.563" y1="10.212" y2="11.063"></line>
<line style="opacity: 50%" x1="14.205" x2="13.001" y1="7.5" y2="7.5"></line>
<line style="opacity: 50%" x1="21.795" x2="23" y1="7.5" y2="7.5"></line>
<line style="opacity: 50%" x1="15.316" x2="14.464" y1="10.184" y2="11.036"></line>
<line style="opacity: 50%" x1="20.711" x2="21.563" y1="4.789" y2="3.937"></line>
<circle cx="18" cy="7.5" r="2.169" style="opacity: 50%"></circle>
</svg>
</symbol>
<symbol id="svg-pencil" viewbox="0 0 24 24">
<svg class="icon-tabler-pencil-code" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4"></path>
<path d="M13.5 6.5l4 4"></path>
<path d="M20 21l2 -2l-2 -2"></path>
<path d="M17 17l-2 2l2 2"></path>
</svg>
</symbol>
<symbol id="svg-eye" viewbox="0 0 24 24">
<svg class="icon-tabler-eye-code" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
<path d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008"></path>
<path d="M20 21l2 -2l-2 -2"></path>
<path d="M17 17l-2 2l2 2"></path>
</svg>
</symbol>
</svg>
<input class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<input class="sidebar-toggle" id="__toc" name="__toc" type="checkbox"/>
<label class="overlay sidebar-overlay" for="__navigation">
<div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
<div class="visually-hidden">Hide table of contents sidebar</div>
</label>
<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>
<div class="page">
<header class="mobile-header">
<div class="header-left">
<label class="nav-overlay-icon" for="__navigation">
<div class="visually-hidden">Toggle site navigation sidebar</div>
<i class="icon"><svg><use href="#svg-menu"></use></svg></i>
</label>
</div>
<div class="header-center">
<a href="../index.html"><div class="brand">STACIE 1.0</div></a>
</div>
<div class="header-right">
<div class="theme-toggle-container theme-toggle-header">
<button class="theme-toggle">
<div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
<svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
<svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
<svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
<svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
</button>
</div>
<label class="toc-overlay-icon toc-header-icon" for="__toc">
<div class="visually-hidden">Toggle table of contents sidebar</div>
<i class="icon"><svg><use href="#svg-toc"></use></svg></i>
</label>
</div>
</header>
<aside class="sidebar-drawer">
<div class="sidebar-container">
<div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
<div class="sidebar-logo-container">
<img alt="Light Logo" class="sidebar-logo only-light" src="../_static/stacie-logo-black.svg"/>
<img alt="Dark Logo" class="sidebar-logo only-dark" src="../_static/stacie-logo-white.svg"/>
</div>
<span class="sidebar-brand-text">STACIE 1.0</span>
</a><form action="../search.html" class="sidebar-search-container" method="get" role="search">
<input aria-label="Search" class="sidebar-search" name="q" placeholder="Search"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Getting Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/licenses.html">Licenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/usage.html">Usage Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/cite.html">How to Cite</a></li>
</ul>
</input></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../theory/index.html">Theory</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Theory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/notation.html">Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/overview.html">STACIE Algorithm Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/model.html">Model Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/statistics.html">Parameter Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/cutoff.html">Frequency Cutoff</a></li>
</ul>
</input></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../preparing_inputs/index.html">Preparing Inputs</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Preparing Inputs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../preparing_inputs/data_sufficiency.html">How to Prepare Sufficient Inputs for STACIE?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preparing_inputs/block_averages.html">Reducing Storage Requirements with Block Averages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preparing_inputs/molecular_dynamics.html">Recommendations for MD Simulations</a></li>
</ul>
</input></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../properties/index.html">Properties Derived from the Autocorrelation Function</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Properties Derived from the Autocorrelation Function</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../properties/error_estimates.html">Uncertainty of the Mean of Time-Correlated Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/autocorrelation_time.html">Integrated and Exponential Autocorrelation Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/shear_viscosity.html">Shear Viscosity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/bulk_viscosity.html">Bulk Viscosity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/thermal_conductivity.html">Thermal Conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/electrical_conductivity.html">Ionic Electrical Conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties/diffusion_coefficient.html">Diffusion Coefficient</a></li>
</ul>
</input></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Worked Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Worked Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="minimal.html">Minimal Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="error_mean.html">Uncertainty of the Mean of Time-Correlated Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="applicability.html">Applicability of the Lorentz Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="surface_diffusion.html">Diffusion on a Surface with Newtonian Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="lj_shear_viscosity.html">Shear Viscosity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lj_bulk_viscosity.html">Bulk Viscosity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Thermal Conductivity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="molten_salt.html">Ionic Electrical Conductivity of Molten Sodium Chloride at 1100 K (OpenMM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utility Module for Plots Reused in Multiple Examples.</a></li>
</ul>
</input></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../development/index.html">Development</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Development</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/contributing.html">Contributor Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/setup.html">Development Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/changelog.html">Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/release.html">How to Make a Release</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/modules.html">Application Programming Interface</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Application Programming Interface</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../apidocs/stacie.html">stacie package</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of stacie package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.conditioning.html">stacie.conditioning module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.cost.html">stacie.cost module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.cutoff.html">stacie.cutoff module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.estimate.html">stacie.estimate module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.model.html">stacie.model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.plot.html">stacie.plot module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.spectrum.html">stacie.spectrum module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.synthetic.html">stacie.synthetic module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apidocs/stacie.utils.html">stacie.utils module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of Conduct</a></li>
</ul>
</div>
</div>
</div>
</div>
</aside>
<div class="main">
<div class="content">
<div class="article-container">
<a class="back-to-top muted-link" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
</svg>
<span>Back to top</span>
</a>
<div class="content-icon-container">
<div class="view-this-page">
<a class="muted-link" href="https://github.com/molmod/stacie/blob/main/docs/examples/lj_thermal_conductivity.py?plain=true" title="View this page">
<svg><use href="#svg-eye"></use></svg>
<span class="visually-hidden">View this page</span>
</a>
</div><div class="edit-this-page">
<a class="muted-link" href="https://github.com/molmod/stacie/edit/main/docs/examples/lj_thermal_conductivity.py" title="Edit this page">
<svg><use href="#svg-pencil"></use></svg>
<span class="visually-hidden">Edit this page</span>
</a>
</div><div class="theme-toggle-container theme-toggle-content">
<button class="theme-toggle">
<div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
<svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
<svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
<svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
<svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
</button>
</div>
<label class="toc-overlay-icon toc-content-icon" for="__toc">
<div class="visually-hidden">Toggle table of contents sidebar</div>
<i class="icon"><svg><use href="#svg-toc"></use></svg></i>
</label>
</div>
<article id="furo-main-content" role="main">
<section class="tex2jax_ignore mathjax_ignore" id="thermal-conductivity-of-a-lennard-jones-liquid-near-the-triple-point-lammps">
<h1>Thermal Conductivity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)<a class="headerlink" href="#thermal-conductivity-of-a-lennard-jones-liquid-near-the-triple-point-lammps" title="Link to this heading">¶</a></h1>
<p>This example shows how to derive the thermal conductivity
using heat flux data from a LAMMPS simulation.
It uses the same production runs and conventions
as in the <a class="reference internal" href="lj_shear_viscosity.html"><span class="std std-doc">Shear viscosity example</span></a>.
The required theoretical background is explained the section
<a class="reference internal" href="../properties/thermal_conductivity.html"><span class="std std-doc">Thermal Conductivity</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A Lennard-Jones system only exhibits pairwise interactions,
for which the LAMMPS command <code class="docutils literal notranslate"><span class="pre">compute/heat</span> <span class="pre">flux</span></code> produces valid results.
For systems with three- or higher-body interactions, one cannot simply use the same command.
Consult the theory section on <a class="reference internal" href="../properties/thermal_conductivity.html"><span class="std std-doc">thermal conductivity</span></a>
for more background.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The results in this example were obtained using
<a class="reference external" href="https://github.com/lammps/lammps/releases/tag/stable_29Aug2024_update3">LAMMPS 29 Aug 2024 Update 3</a>.
Minor differences may arise when using a different version of LAMMPS,
or even the same version compiled with a different compiler.</p>
</div>
<section id="library-imports-and-configuration">
<h2>Library Imports and Configuration<a class="headerlink" href="#library-imports-and-configuration" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/os.html#module-os" title="os"><span class="nn">os</span></a>
<span class="kn">import</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">path</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">yaml</span><span class="w"> </span><span class="kn">import</span> <span class="n">safe_load</span>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../apidocs/stacie.html#module-stacie" title="stacie"><span class="nn">stacie</span></a><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.utils.html#stacie.utils.UnitConfig" title="stacie.utils.UnitConfig"><span class="n">UnitConfig</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.spectrum.html#stacie.spectrum.compute_spectrum" title="stacie.spectrum.compute_spectrum"><span class="n">compute_spectrum</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.estimate.html#stacie.estimate.estimate_acint" title="stacie.estimate.estimate_acint"><span class="n">estimate_acint</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.model.html#stacie.model.LorentzModel" title="stacie.model.LorentzModel"><span class="n">LorentzModel</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.plot.html#stacie.plot.plot_fitted_spectrum" title="stacie.plot.plot_fitted_spectrum"><span class="n">plot_fitted_spectrum</span></a><span class="p">,</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.plot.html#stacie.plot.plot_extras" title="stacie.plot.plot_extras"><span class="n">plot_extras</span></a><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mpl</span><span class="o">.</span><span class="n">rc_file</span><span class="p">(</span><span class="s2">"matplotlibrc"</span><span class="p">)</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = ["svg"]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># You normally do not need to change this path.</span>
<span class="c1"># It only needs to be overridden when building the documentation.</span>
<span class="n">DATA_ROOT</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/os.html#os.getenv" title="os.getenv"><span class="n">os</span><span class="o">.</span><span class="n">getenv</span></a><span class="p">(</span><span class="s2">"DATA_ROOT"</span><span class="p">,</span> <span class="s2">"./"</span><span class="p">))</span> <span class="o">/</span> <span class="s2">"lammps_lj3d/sims/"</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analysis-of-the-production-simulations">
<h2>Analysis of the Production Simulations<a class="headerlink" href="#analysis-of-the-production-simulations" title="Link to this heading">¶</a></h2>
<p>The function <code class="docutils literal notranslate"><span class="pre">estimate_thermal_conductivity</span></code> implements the analysis,
assuming the data have been read from the LAMMPS outputs and are passed as function arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">estimate_thermal_conductivity</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">jcomps</span><span class="p">,</span> <span class="n">av_temperature</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="n">timestep</span><span class="p">):</span>
    <span class="c1"># Create the spectrum of the heat flux fluctuations.</span>
    <span class="c1"># Note that the Boltzmann constant is 1 in reduced LJ units.</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.utils.html#stacie.utils.UnitConfig" title="stacie.utils.UnitConfig"><span class="n">uc</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.utils.html#stacie.utils.UnitConfig" title="stacie.utils.UnitConfig"><span class="n">UnitConfig</span></a><span class="p">(</span>
        <span class="n">acint_fmt</span><span class="o">=</span><span class="s2">".3f"</span><span class="p">,</span>
        <span class="n">acint_symbol</span><span class="o">=</span><span class="s2">"κ"</span><span class="p">,</span>
        <span class="n">acint_unit_str</span><span class="o">=</span><span class="s2">"κ*"</span><span class="p">,</span>
        <span class="n">freq_unit_str</span><span class="o">=</span><span class="s2">"1/τ*"</span><span class="p">,</span>
        <span class="n">time_fmt</span><span class="o">=</span><span class="s2">".3f"</span><span class="p">,</span>
        <span class="n">time_unit_str</span><span class="o">=</span><span class="s2">"τ*"</span><span class="p">,</span>
    <span class="p">)</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.spectrum.html#stacie.spectrum.Spectrum" title="stacie.spectrum.Spectrum"><span class="n">spectrum</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.spectrum.html#stacie.spectrum.compute_spectrum" title="stacie.spectrum.compute_spectrum"><span class="n">compute_spectrum</span></a><span class="p">(</span>
        <span class="n">jcomps</span><span class="p">,</span>
        <span class="n">prefactors</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">volume</span> <span class="o">*</span> <span class="n">av_temperature</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Estimate the viscosity from the spectrum.</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.estimate.html#stacie.estimate.Result" title="stacie.estimate.Result"><span class="n">result</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.estimate.html#stacie.estimate.estimate_acint" title="stacie.estimate.estimate_acint"><span class="n">estimate_acint</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../apidocs/stacie.spectrum.html#stacie.spectrum.Spectrum" title="stacie.spectrum.Spectrum"><span class="n">spectrum</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.model.html#stacie.model.LorentzModel" title="stacie.model.LorentzModel"><span class="n">LorentzModel</span></a><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">uc</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="../apidocs/stacie.utils.html#stacie.utils.UnitConfig" title="stacie.utils.UnitConfig"><span class="n">uc</span></a><span class="p">)</span>

    <span class="c1"># Plot some basic analysis figures.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_spectrum"</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_spectrum"</span><span class="p">)</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.plot.html#stacie.plot.plot_fitted_spectrum" title="stacie.plot.plot_fitted_spectrum"><span class="n">plot_fitted_spectrum</span></a><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.utils.html#stacie.utils.UnitConfig" title="stacie.utils.UnitConfig"><span class="n">uc</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.estimate.html#stacie.estimate.Result" title="stacie.estimate.Result"><span class="n">result</span></a><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_extras"</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_extras"</span><span class="p">)</span>
    <a class="sphinx-codeautolink-a" href="../apidocs/stacie.plot.html#stacie.plot.plot_extras" title="stacie.plot.plot_extras"><span class="n">plot_extras</span></a><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.utils.html#stacie.utils.UnitConfig" title="stacie.utils.UnitConfig"><span class="n">uc</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.estimate.html#stacie.estimate.Result" title="stacie.estimate.Result"><span class="n">result</span></a><span class="p">)</span>

    <span class="c1"># Return the viscosity</span>
    <span class="k">return</span> <a class="sphinx-codeautolink-a" href="../apidocs/stacie.estimate.html#stacie.estimate.Result.acint" title="stacie.estimate.Result.acint"><span class="n">result</span><span class="o">.</span><span class="n">acint</span></a>
</pre></div>
</div>
</div>
</div>
<p>The following cell implements the analysis of the production simulations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">demo_production</span><span class="p">(</span><span class="n">npart</span><span class="p">:</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#int" title="int"><span class="nb">int</span></a> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ntraj</span><span class="p">:</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#int" title="int"><span class="nb">int</span></a> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Perform the analysis of the production runs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npart</span>
<span class="sd">        Number of parts in the production runs.</span>
<span class="sd">        For the initial production runs, this is 1.</span>
<span class="sd">    ntraj</span>
<span class="sd">        Number of trajectories in the production runs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kappa</span>
<span class="sd">        The estimated thermal conductivity.</span>
<span class="sd">    """</span>
    <span class="c1"># Load the configuration from the YAML file.</span>
    <span class="k">with</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#open" title="open"><span class="nb">open</span></a><span class="p">(</span><span class="n">DATA_ROOT</span> <span class="o">/</span> <span class="s2">"replica_0000_part_00/info.yaml"</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">safe_load</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>

    <span class="c1"># Load trajectory data, without hardcoding the number of runs and parts.</span>
    <span class="n">thermos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">heatfluxes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">itraj</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="n">ntraj</span><span class="p">):</span>
        <span class="n">thermos</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">heatfluxes</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">ipart</span> <span class="ow">in</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/stdtypes.html#range" title="range"><span class="nb">range</span></a><span class="p">(</span><span class="n">npart</span><span class="p">):</span>
            <span class="n">prod_dir</span> <span class="o">=</span> <span class="n">DATA_ROOT</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"replica_</span><span class="si">{</span><span class="n">itraj</span><span class="si">:</span><span class="s2">04d</span><span class="si">}</span><span class="s2">_part_</span><span class="si">{</span><span class="n">ipart</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">/"</span>
            <span class="n">thermos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="numpy.loadtxt"><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span></a><span class="p">(</span><span class="n">prod_dir</span> <span class="o">/</span> <span class="s2">"nve_thermo.txt"</span><span class="p">))</span>
            <span class="n">heatfluxes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="numpy.loadtxt"><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span></a><span class="p">(</span><span class="n">prod_dir</span> <span class="o">/</span> <span class="s2">"nve_heatflux_blav.txt"</span><span class="p">))</span>
    <span class="n">thermos</span> <span class="o">=</span> <span class="p">[</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">parts</span> <span class="ow">in</span> <span class="n">thermos</span><span class="p">]</span>
    <span class="n">heatfluxes</span> <span class="o">=</span> <span class="p">[</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">parts</span> <span class="ow">in</span> <span class="n">heatfluxes</span><span class="p">]</span>

    <span class="c1"># Compute the average temperature.</span>
    <span class="n">av_temperature</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">([</span><span class="n">thermo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">thermo</span> <span class="ow">in</span> <span class="n">thermos</span><span class="p">])</span>

    <span class="c1"># Compute the thermal conductivity.</span>
    <span class="c1"># Note that the last three columns are not used in the analysis.</span>
    <span class="c1"># According to the LAMMPS documentation, the last three columns</span>
    <span class="c1"># only contain the convective contribution to the heat flux.</span>
    <span class="c1"># See https://docs.lammps.org/compute_heat_flux.html</span>
    <span class="n">jcomps</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">([</span><span class="n">heatflux</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">heatflux</span> <span class="ow">in</span> <span class="n">heatfluxes</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">estimate_thermal_conductivity</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">"part</span><span class="si">{</span><span class="n">npart</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
        <span class="n">jcomps</span><span class="p">,</span>
        <span class="n">av_temperature</span><span class="p">,</span>
        <span class="n">info</span><span class="p">[</span><span class="s2">"volume"</span><span class="p">],</span>
        <span class="n">info</span><span class="p">[</span><span class="s2">"timestep"</span><span class="p">]</span> <span class="o">*</span> <span class="n">info</span><span class="p">[</span><span class="s2">"block_size"</span><span class="p">],</span>
    <span class="p">)</span>


<span class="n">kappa_production</span> <span class="o">=</span> <span class="n">demo_production</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CUTOFF FREQUENCY SCAN cv2l(125%)
     neff   criterion  fcut [1/τ*]
---------  ----------  ----------
     15.0         inf    4.71e-02  (Variance of the correlation time estimate is too large.)
     15.9         inf    5.01e-02  (Variance of the correlation time estimate is too large.)
     16.9         inf    5.34e-02  (Variance of the correlation time estimate is too large.)
     18.0         inf    5.68e-02  (Variance of the correlation time estimate is too large.)
     19.1         inf    6.05e-02  (opt: Hessian matrix has non-positive eigenvalues: evals=array([-6.75412020e-06,  4.43842256e-01,  2.55616450e+00]))
     20.3         inf    6.44e-02  (opt: Hessian matrix has non-positive eigenvalues: evals=array([-3.50407301e-06,  4.43068635e-01,  2.55693487e+00]))
     21.6         inf    6.85e-02  (No correlation time estimate available.)
     23.0         inf    7.30e-02  (No correlation time estimate available.)
     24.4         inf    7.77e-02  (No correlation time estimate available.)
     25.9         inf    8.27e-02  (No correlation time estimate available.)
     27.6         inf    8.80e-02  (No correlation time estimate available.)
     29.3         inf    9.37e-02  (No correlation time estimate available.)
     31.2         inf    9.97e-02  (No correlation time estimate available.)
     33.2         inf    1.06e-01  (No correlation time estimate available.)
     35.3         inf    1.13e-01  (No correlation time estimate available.)
     37.5         inf    1.20e-01  (No correlation time estimate available.)
     39.9         inf    1.28e-01  (No correlation time estimate available.)
     42.4         inf    1.36e-01  (No correlation time estimate available.)
     45.1         inf    1.45e-01  (opt: Hessian matrix has non-positive eigenvalues: evals=array([-1.00541799e-04,  4.38053694e-01,  2.56204685e+00]))
     48.0         inf    1.54e-01  (opt: Hessian matrix has non-positive eigenvalues: evals=array([-1.17919538e-04,  4.37106550e-01,  2.56301137e+00]))
     51.1         inf    1.64e-01  (opt: Hessian matrix has non-positive eigenvalues: evals=array([-9.50267075e-05,  4.36440454e-01,  2.56365457e+00]))
     54.4         inf    1.75e-01  (Variance of the correlation time estimate is too large.)
     57.8         inf    1.86e-01  (Variance of the correlation time estimate is too large.)
     61.5         inf    1.98e-01  (Variance of the correlation time estimate is too large.)
     65.5         inf    2.11e-01  (Variance of the correlation time estimate is too large.)
     69.7         inf    2.25e-01  (Variance of the correlation time estimate is too large.)
     74.1         inf    2.39e-01  (Variance of the correlation time estimate is too large.)
     78.9         inf    2.55e-01  (Variance of the correlation time estimate is too large.)
     83.9         inf    2.71e-01  (Variance of the correlation time estimate is too large.)
     89.3         inf    2.89e-01  (Variance of the correlation time estimate is too large.)
     95.0         inf    3.07e-01  (Variance of the correlation time estimate is too large.)
    101.1         inf    3.27e-01  (Variance of the correlation time estimate is too large.)
    107.6         inf    3.48e-01  (Variance of the correlation time estimate is too large.)
    114.5         inf    3.70e-01  (Variance of the correlation time estimate is too large.)
    121.9         inf    3.94e-01  (Variance of the correlation time estimate is too large.)
    129.7         inf    4.20e-01  (Variance of the correlation time estimate is too large.)
    138.0         inf    4.47e-01  (Variance of the correlation time estimate is too large.)
    146.9         inf    4.76e-01  (Variance of the correlation time estimate is too large.)
    156.3         inf    5.06e-01  (Variance of the correlation time estimate is too large.)
    166.4         inf    5.39e-01  (Variance of the correlation time estimate is too large.)
    177.1         inf    5.74e-01  (Variance of the correlation time estimate is too large.)
    188.5         inf    6.11e-01  (Variance of the correlation time estimate is too large.)
    200.6         inf    6.50e-01  (Variance of the correlation time estimate is too large.)
    213.5         inf    6.92e-01  (Variance of the correlation time estimate is too large.)
    227.2         inf    7.37e-01  (Variance of the correlation time estimate is too large.)
    241.9         inf    7.84e-01  (Variance of the correlation time estimate is too large.)
    257.4         inf    8.35e-01  (Variance of the correlation time estimate is too large.)
    274.0         inf    8.89e-01  (Variance of the correlation time estimate is too large.)
    291.6        -2.6    9.46e-01
    310.4        -2.9    1.01e+00
    330.4        -3.2    1.07e+00
    351.7        -3.5    1.14e+00
    374.3        -3.7    1.21e+00
    398.4        -3.8    1.29e+00
    424.1        -3.8    1.38e+00
    451.4        -3.8    1.47e+00
    480.5        -3.8    1.56e+00
    511.5        -4.0    1.66e+00
    544.4        -4.6    1.77e+00
    579.5        -5.7    1.88e+00
    616.9        -6.9    2.00e+00
    656.6        -8.0    2.13e+00
    698.9        -8.5    2.27e+00
    744.0        -8.3    2.42e+00
    791.9        -7.4    2.57e+00
    843.0        -6.1    2.74e+00
    897.3        -4.8    2.91e+00
    955.1        -3.4    3.10e+00
   1016.7        -1.2    3.30e+00
Reached the maximum number of effective points (1000).

INPUT TIME SERIES
    Time step:                     0.030 τ*
    Simulation time:               300.000 τ*
    Maximum degrees of freedom:    600.0

MAIN RESULTS
    Autocorrelation integral:      6.936 ± 0.029 κ*
    Integrated correlation time:   0.107 ± 0.000 τ*

SANITY CHECKS (weighted averages over cutoff grid)
    Effective number of points:    702.7 (ideally &gt; 60)
    Regression cost Z-score:       2.2 (ideally &lt; 2)
    Cutoff criterion Z-score:      1.7 (ideally &lt; 2)

MODEL lorentz(0.1) | CUTOFF CRITERION cv2l(125%)
    Number of parameters:          3
    Average cutoff frequency:      2.28e+00 1/τ*
    Exponential correlation time:  0.090 ± 0.001 τ*

RECOMMENDED SIMULATION SETTINGS (EXPONENTIAL CORR. TIME)
    Block time:                    0.028 ± 0.001 τ*
    Simulation time:               5.625 ± 0.012 τ*
</pre></div>
</div>
<img alt="../_images/2f33ba6baff65bcb47a7a87091c25964179eccb511808870652ae3b2cf1ad742.svg" src="../_images/2f33ba6baff65bcb47a7a87091c25964179eccb511808870652ae3b2cf1ad742.svg"/>
<img alt="../_images/f34068c115d3523edffb85635f21a8125e9d7598237f62509fcc13f689274428.svg" src="../_images/f34068c115d3523edffb85635f21a8125e9d7598237f62509fcc13f689274428.svg"/>
</div>
</div>
<p>The exponential correlation time of the heat flux tensor fluctuations is five times shorter
than that of the pressure tensor fluctuations.
This means that the thermal conductivity is a bit easier to compute than the viscosity.
Note that the selected block size is still compatible with this shorter time scale.</p>
<p>Similarly to the bulk viscosity, the Z-scores are clearly positive.
This could be for the same reasons as in the bulk viscosity example.
In addition, the block size of 0.03 τ* is slightly larger than the recommended 0.028 τ*,
meaning that the spectrum might be perturbed by (very) small aliasing effects
that could distort the fit.</p>
</section>
<section id="comparison-to-literature-results">
<h2>Comparison to Literature Results<a class="headerlink" href="#comparison-to-literature-results" title="Link to this heading">¶</a></h2>
<p>A detailed literature survey of computational estimates of the thermal conductivity
of a Lennard-Jones fluid can be found in <span id="id1">[<a class="reference internal" href="../references.html#id23" title="S. Viscardy, J. Servantie, and P. Gaspard. Transport and helfand moments in the lennard-jones fluid. ii. thermal conductivity. J. Chem. Phys., 126(18):184513, 2007. doi:10.1063/1.2724821.">VSG07b</a>]</span>.
Viscardi also computes new estimates, one of which is included in the table below.
This value can be directly comparable to the current notebook,
because the settings are identical
(<span class="math notranslate nohighlight">\(r_\text{cut}^{*}=2.5\)</span>, <span class="math notranslate nohighlight">\(N=1372\)</span>, <span class="math notranslate nohighlight">\(T^*=0.722\)</span> and <span class="math notranslate nohighlight">\(\rho^{*}=0.8442\)</span>).</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Simulation time  [τ*]</p></th>
<th class="head"><p>Thermal conductivity [κ*]</p></th>
<th class="head"><p>Reference</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EMD NVE (STACIE)</p></td>
<td><p>3600</p></td>
<td><p>6.837 ± 0.081</p></td>
<td><p>(here) initial</p></td>
</tr>
<tr class="row-odd"><td><p>EMD NVE (STACIE)</p></td>
<td><p>10800</p></td>
<td><p>6.968 ± 0.046</p></td>
<td><p>(here) extension 1</p></td>
</tr>
<tr class="row-even"><td><p>EMD NVE (STACIE)</p></td>
<td><p>30000</p></td>
<td><p>6.936 ± 0.029</p></td>
<td><p>(here) extension 2</p></td>
</tr>
<tr class="row-odd"><td><p>EMD NVE (Helfand-moment)</p></td>
<td><p>600000</p></td>
<td><p>6.946 ± 0.12</p></td>
<td><p><span id="id2">[<a class="reference internal" href="../references.html#id23" title="S. Viscardy, J. Servantie, and P. Gaspard. Transport and helfand moments in the lennard-jones fluid. ii. thermal conductivity. J. Chem. Phys., 126(18):184513, 2007. doi:10.1063/1.2724821.">VSG07b</a>]</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>This small comparison confirms that STACIE can reproduce a well-known thermal conductivity result,
with small error bars, while using much less trajectory data than existing methods.</p>
</section>
<section id="regression-tests">
<h2>Regression Tests<a class="headerlink" href="#regression-tests" title="Link to this heading">¶</a></h2>
<p>If you are experimenting with this notebook, you can ignore any exceptions below.
The tests are only meant to pass for the notebook in its original form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#abs" title="abs"><span class="nb">abs</span></a><span class="p">(</span><span class="n">kappa_production</span> <span class="o">-</span> <span class="mf">6.953</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">:</span>
    <span class="k">raise</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="ValueError"><span class="ne">ValueError</span></a><span class="p">(</span><span class="sa">f</span><span class="s2">"wrong thermal conductivity (production): </span><span class="si">{</span><span class="n">kappa_production</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</article>
</div>
<footer>
<div class="related-pages">
<a class="next-page" href="molten_salt.html">
<div class="page-info">
<div class="context">
<span>Next</span>
</div>
<div class="title">Ionic Electrical Conductivity of Molten Sodium Chloride at 1100 K (OpenMM)</div>
</div>
<svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
</a>
<a class="prev-page" href="lj_bulk_viscosity.html">
<svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
<div class="page-info">
<div class="context">
<span>Previous</span>
</div>
<div class="title">Bulk Viscosity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)</div>
</div>
</a>
</div>
<div class="bottom-of-page">
<div class="left-details">
<div class="copyright">
                Copyright © 2024--2025, Gözdenur Toraman, Toon Verstraelen
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
</div>
<div class="right-details">
<div class="icons">
<a aria-label="Center for Molecular Modeling" class="muted-link" href="https://molmod.ugent.be"><svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 16 16">
<path d="M 8,0.23203771 1.2708502,4.1166743 V 7.586584 H 2.0757403 V 4.5814695 L 8,1.1606847 13.924259,4.5814695 V 7.586584 h 0.80489 V 4.1166743 Z"></path>
<path d="m 8,3.6329842 c -2.4076366,0 -4.3683267,1.9606901 -4.3683267,4.368326 0,1.0499591 0.3736113,2.0145218 0.9938323,2.7689368 L 4.9523743,9.845379 C 4.6268573,9.3073839 4.436564,8.6780482 4.436564,8.0013102 4.436564,6.0283899 6.027079,4.4378742 8,4.4378742 c 1.9729204,0 3.563435,1.5905157 3.563435,3.563436 0,0.676738 -0.190293,1.3060737 -0.515809,1.8440688 l 0.326868,0.924868 c 0.620221,-0.754415 0.993832,-1.7189777 0.993832,-2.7689368 0,-2.4076359 -1.96069,-4.3683267 -4.368326,-4.368326 z"></path>
<path d="m 4.5647296,15.767884 2.0103367,-5.68462 0.979439,5.684633 0.8166682,-0.0019 L 7.1003242,8.3914521 H 6.3187358 L 4.1855869,14.427689 2.052438,8.3914521 H 1.2708502 L 2e-7,15.765962 l 0.81666821,0.0019 0.97943899,-5.684633 2.0103367,5.68462 z"></path>
<path d="m 12.193555,15.767884 2.010337,-5.68462 0.979438,5.684633 L 16,15.765962 14.729149,8.3914521 H 13.947561 L 11.814413,14.427689 9.6812637,8.3914521 H 8.8996758 l -1.2708506,7.3745099 0.8166683,0.002 0.9794395,-5.684632 2.010337,5.684619 z"></path>
</svg></a>
<a aria-label="Soete Laboratory" class="muted-link" href="https://www.ugent.be/ea/emsme/en/research/soete"><svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 16 16">
<path d="M 1.2243149,11.312034 V 0.3537872 c 0,-0.47171662 3.2133726,-0.47171662 3.2133726,0 V 11.275667 c 0.038589,1.391853 0.8362299,2.107621 2.6118885,2.188801 0.3456227,0 0.3456227,2.535532 0,2.535532 -2.5872928,0 -5.8252611,-1.272498 -5.8252611,-4.687966 z"></path>
<path d="M 9.0151601,16 C 12.286758,15.9977 14.766446,14.194112 14.775658,11.101887 14.784658,8.0882805 12.485826,7.1827295 10.791465,6.4316093 9.6750417,5.9366938 8.1559684,5.3529148 8.1229508,4.0958595 8.089931,2.8388043 9.1956669,2.5059896 10.318156,2.4898791 c 1.24952,-0.017939 2.35918,0.6351356 3.134465,1.0460205 0.333368,0.1766787 0.80108,-1.909061 0.109685,-2.62234708 C 12.969839,0.30232534 11.507764,0.01488162 9.9750266,0.01430271 6.3231448,0.01292984 4.9375194,2.3766199 4.917302,4.4194486 4.894588,6.7146645 6.6302121,8.1331941 8.4220755,8.9015433 c 1.235865,0.5299374 3.0428875,0.956338 3.0526165,2.6331567 0.007,1.208881 -1.112249,1.929768 -2.4595319,1.929768 -0.4639212,0 -0.4729202,2.535532 0,2.535532 z"></path>
</svg></a>
<a aria-label="Ghent University" class="muted-link" href="https://ugent.be"><svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 16 16">
<path d="M 8.4671319,6.1991107 H 7.5328685 V 12.263022 H 8.4671319 V 6.1991107"></path>
<path d="M 6.5989047,6.1991107 H 5.6647163 V 12.263022 H 6.5989047 V 6.1991107"></path>
<path d="M 4.7307525,6.1991107 H 3.7964891 V 12.263022 H 4.7307525 V 6.1991107"></path>
<path d="M 2.8626002,6.1991107 H 1.9283368 V 12.263022 H 2.8626002 V 6.1991107"></path>
<path d="M 10.335284,6.1991107 H 9.4010957 V 12.263022 H 10.335284 V 6.1991107"></path>
<path d="m 12.203511,6.1991107 h -0.934263 v 6.0639113 h 0.934263 V 6.1991107"></path>
<path d="M 14.071664,6.1991107 H 13.1374 v 6.0639113 h 0.934264 V 6.1991107"></path>
<path d="M 15.028173,14.131773 H 0.97182731 V 13.196985 H 15.028173 v 0.934788"></path>
<path d="M 14.071664,5.2648473 H 1.9283368 L 0.99437307,4.3309584 H 15.005627 l -0.933963,0.9338889"></path>
<path d="M 15.962062,16 H 0.03793844 V 15.065138 H 15.962062 V 16"></path>
<path d="M 15.962062,2.8200179 7.9998879,7.5076002e-8 0.03793844,2.8200179 V 3.8118816 L 7.9998879,0.99246298 15.962062,3.8118816 V 2.8200179"></path>
</svg></a>
<a aria-label="GitHub" class="muted-link" href="https://github.com/molmod/stacie"><svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 16 16">
<path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
</svg></a>
</div>
</div>
</div>
</footer>
</div>
<aside class="toc-drawer">
<div class="toc-sticky toc-scroll">
<div class="toc-title-container">
<span class="toc-title">
            On this page
          </span>
</div>
<div class="toc-tree-container">
<div class="toc-tree">
<ul>
<li><a class="reference internal" href="#">Thermal Conductivity of a Lennard-Jones Liquid Near the Triple Point (LAMMPS)</a><ul>
<li><a class="reference internal" href="#library-imports-and-configuration">Library Imports and Configuration</a></li>
<li><a class="reference internal" href="#analysis-of-the-production-simulations">Analysis of the Production Simulations</a></li>
<li><a class="reference internal" href="#comparison-to-literature-results">Comparison to Literature Results</a></li>
<li><a class="reference internal" href="#regression-tests">Regression Tests</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</aside>
</div>
</div><script src="../_static/documentation_options.js?v=f2a433a1"></script>
<script src="../_static/doctools.js?v=9bcbadda"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/scripts/furo.js?v=5fa4622c"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=f281be69"></script>
<script defer="defer" src="https://unpkg.com/@popperjs/core@2"></script>
<script defer="defer" src="https://unpkg.com/tippy.js@6"></script>
<script defer="defer" src="../_static/tippy/examples/lj_thermal_conductivity.e2bb7b68-9fe7-4620-8088-7a35ec58aaad.js"></script>
<script>window.MathJax = {"tex": {"macros": {"mean": "\\operatorname{E}", "var": "\\operatorname{VAR}", "std": "\\operatorname{STD}", "cov": "\\operatorname{COV}", "gdist": "\\operatorname{Gamma}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>